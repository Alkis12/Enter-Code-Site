# Enter Code Site Backend

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—ç–∫–µ–Ω–¥ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ FastAPI, MongoDB –∏ Beanie ODM.

## üöÄ –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: FastAPI + MongoDB + Beanie ODM
- **JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: Access/Refresh —Ç–æ–∫–µ–Ω—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **–†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å**: –°—Ç—É–¥–µ–Ω—Ç—ã, –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏, –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã
- **–°–∏—Å—Ç–µ–º–∞ –∞–±–æ–Ω–µ–º–µ–Ω—Ç–æ–≤**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–Ω—è—Ç–∏—è–º–∏ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- **–ì–∏–±–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫—É—Ä—Å–æ–≤**: –ö—É—Ä—Å—ã ‚Üí –ì—Ä—É–ø–ø—ã ‚Üí –¢–µ–º—ã ‚Üí –ó–∞–¥–∞—á–∏
- **–°—Ç–∞–±–∏–ª—å–Ω—ã–µ —Å–≤—è–∑–∏**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ user_id –≤–º–µ—Å—Ç–æ –∏–∑–º–µ–Ω—è–µ–º—ã—Ö username

## üìã –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

#### üë§ User (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
```python
- id: ObjectId (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä)
- name: str (–∏–º—è)
- surname: str (—Ñ–∞–º–∏–ª–∏—è)
- tg_username: str (Telegram username)
- user_type: enum (student/teacher/admin)
- status: enum (active/inactive)
- phone: str (–Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- avatar_url: str (URL –∞–≤–∞—Ç–∞—Ä–∞, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- bio: str (–±–∏–æ–≥—Ä–∞—Ñ–∏—è, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- password_hash: str (—Ö—ç—à –ø–∞—Ä–æ–ª—è)
- access_token: str (JWT —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞)
- refresh_token: str (—Ç–æ–∫–µ–Ω –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)

# –î–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤:
- subscription_status: enum (paid/unpaid/expired)
- lessons_remaining: int (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∑–∞–Ω—è—Ç–∏–π)
```

#### üè´ Course (–ö—É—Ä—Å)
```python
- id: ObjectId
- name: str (–Ω–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞)
- description: str (–æ–ø–∏—Å–∞–Ω–∏–µ)
- group_ids: List[str] (—Å–ø–∏—Å–æ–∫ ID –≥—Ä—É–ø–ø)
- topic_ids: List[str] (—Å–ø–∏—Å–æ–∫ ID —Ç–µ–º)
```

#### üë• Group (–ì—Ä—É–ø–ø–∞)
```python
- id: ObjectId
- course_id: str (ID –∫—É—Ä—Å–∞)
- name: str (–Ω–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã)
- description: str (–æ–ø–∏—Å–∞–Ω–∏–µ)
- students: List[str] (—Å–ø–∏—Å–æ–∫ user_id —Å—Ç—É–¥–µ–Ω—Ç–æ–≤)
- teachers: List[str] (—Å–ø–∏—Å–æ–∫ user_id –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π)
```

#### üìö Topic (–¢–µ–º–∞)
```python
- id: ObjectId
- name: str (–Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–º—ã)
- description: str (–æ–ø–∏—Å–∞–Ω–∏–µ)
- resources: List[str] (—Ä–µ—Å—É—Ä—Å—ã)
- task_ids: List[str] (—Å–ø–∏—Å–æ–∫ ID –∑–∞–¥–∞—á)
```

#### üìù Task (–ó–∞–¥–∞—á–∞)
```python
- id: ObjectId
- topic_id: str (ID —Ç–µ–º—ã)
- condition: str (—É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏)
- attachments: List[str] (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- chat_history: List[dict] (–∏—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ —Å –ò–ò)
- results: List[TaskResult] (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤)
```

#### üìä TaskResult (–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–¥–∞—á–∏)
```python
- user_id: str (ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- score: float (–æ—Ü–µ–Ω–∫–∞)
- status: enum (no_attempts/wrong_answer/under_review/rejected/correct)
```

## üõ† API –≠–Ω–¥–ø–æ–π–Ω—Ç—ã

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (`/auth`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–π–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –¢–æ–∫–µ–Ω |
|-------|----------|----------|-------|
| POST | `/auth/register` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è + –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è | ‚ùå |
| POST | `/auth/login` | –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É | ‚ùå |
| POST | `/auth/me` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ | ‚úÖ |
| POST | `/auth/user_info` | –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ user_id | ‚ùå |
| POST | `/auth/refresh` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access_token | ‚úÖ |
| POST | `/auth/change_password` | –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è | ‚úÖ |
| POST | `/auth/update_user` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è | ‚úÖ |
| POST | `/auth/logout` | –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã | ‚úÖ |
| DELETE | `/auth/delete_account` | –£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ | ‚úÖ |

### üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (`/users`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–π–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –†–æ–ª—å |
|-------|----------|----------|------|
| POST | `/users/list` | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | Admin |
| POST | `/users/profile` | –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Student+ |
| POST | `/users/search` | –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π | Teacher+ |

### üè´ –ö—É—Ä—Å—ã (`/courses`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–π–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –†–æ–ª—å |
|-------|----------|----------|------|
| POST | `/courses/add` | –°–æ–∑–¥–∞—Ç—å –∫—É—Ä—Å | Teacher+ |
| POST | `/courses/update` | –û–±–Ω–æ–≤–∏—Ç—å –∫—É—Ä—Å | Teacher+ |
| POST | `/courses/info` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫—É—Ä—Å–µ | Student+ |
| POST | `/courses/list` | –°–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤ | Student+ |
| POST | `/courses/my` | –ö—É—Ä—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Student+ |

### üë• –ì—Ä—É–ø–ø—ã (`/groups`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–π–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –†–æ–ª—å |
|-------|----------|----------|------|
| POST | `/groups/add` | –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É | Teacher+ |
| POST | `/groups/update` | –û–±–Ω–æ–≤–∏—Ç—å –≥—Ä—É–ø–ø—É | Teacher+ |
| POST | `/groups/add_student` | –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞ | Teacher+ |
| POST | `/groups/add_students_bulk` | –ú–∞—Å—Å–æ–≤–æ –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ | Teacher+ |
| POST | `/groups/remove_student` | –£–¥–∞–ª–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–∞ | Teacher+ |
| POST | `/groups/add_teacher` | –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è | Admin |
| POST | `/groups/remove_teacher` | –£–¥–∞–ª–∏—Ç—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è | Admin |
| POST | `/groups/info` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥—Ä—É–ø–ø–µ | Student+ |
| POST | `/groups/list` | –°–ø–∏—Å–æ–∫ –≥—Ä—É–ø–ø | Student+ |
| POST | `/groups/my` | –ì—Ä—É–ø–ø—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Student+ |

### üìö –¢–µ–º—ã (`/topics`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–π–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –†–æ–ª—å |
|-------|----------|----------|------|
| POST | `/topics/add` | –°–æ–∑–¥–∞—Ç—å —Ç–µ–º—É | Teacher+ |
| POST | `/topics/update` | –û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–º—É | Teacher+ |
| POST | `/topics/info` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–º–µ | Student+ |
| POST | `/topics/result` | –ü—Ä–æ–≥—Ä–µ—Å—Å —Å—Ç—É–¥–µ–Ω—Ç–∞ –ø–æ —Ç–µ–º–µ | Student+ |
| POST | `/topics/list` | –°–ø–∏—Å–æ–∫ —Ç–µ–º | Student+ |

### üìù –ó–∞–¥–∞—á–∏ (`/tasks`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–π–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –†–æ–ª—å |
|-------|----------|----------|------|
| POST | `/tasks/add` | –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É | Teacher+ |
| POST | `/tasks/update` | –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–¥–∞—á—É | Teacher+ |
| POST | `/tasks/info` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–¥–∞—á–µ | Student+ |
| POST | `/tasks/submit` | –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ | Student |
| POST | `/tasks/student_status` | –°—Ç–∞—Ç—É—Å —Å—Ç—É–¥–µ–Ω—Ç–∞ –ø–æ –∑–∞–¥–∞—á–µ | Student+ |

### üí≥ –ê–±–æ–Ω–µ–º–µ–Ω—Ç—ã (`/subscription`)

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–π–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –†–æ–ª—å |
|-------|----------|----------|------|
| POST | `/subscription/extend` | –ü—Ä–æ–¥–ª–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç | Teacher+ |
| POST | `/subscription/info` | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–±–æ–Ω–µ–º–µ–Ω—Ç–µ | Student+ |
| POST | `/subscription/use-lesson` | –°–ø–∏—Å–∞—Ç—å –∑–∞–Ω—è—Ç–∏–µ | Teacher+ |
| POST | `/subscription/check-validity` | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | Student+ |

## ÔøΩ –ù–µ–¥–∞–≤–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### ‚ö° –í–µ—Ä—Å–∏—è 2.0.0 - –ö—Ä—É–ø–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

#### üèó –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ user_id
- **–°—Ç–∞–±–∏–ª—å–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã**: –ü–µ—Ä–µ—Ö–æ–¥ –æ—Ç `tg_username` –∫ `user_id` –≤–æ –≤—Å–µ—Ö —Å–≤—è–∑—è—Ö
- **–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö**: –ò—Å–∫–ª—é—á–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ —Å–º–µ–Ω–µ username –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: API –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å tg_username —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π

#### üîê –£–ª—É—á—à–µ–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**: `/auth/register` —Å—Ä–∞–∑—É –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã –∏ user_id
- **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã**: `/auth/login` –∏ `/auth/me` –≤–∫–ª—é—á–∞—é—Ç user_id
- **–ù–æ–≤—ã–π —ç–Ω–¥–ø–æ–π–Ω—Ç**: `/auth/user_info` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ user_id

#### üõ° –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTPException –∏ –æ–±—â–∏—Ö –æ—à–∏–±–æ–∫
- **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—Å–µ –æ—à–∏–±–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞—é—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±–µ–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ç–∞–ª–µ–π
- **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤**: Try-catch –±–ª–æ–∫–∏ –≤–æ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–¥–∞—Ö

#### üîç –£–ª—É—á—à–µ–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **Health Check**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è MongoDB –≤ `/health`
- **Structured Logging**: –õ–æ–≥–∏ —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏ –∏ —É—Ä–æ–≤–Ω—è–º–∏ –≤–∞–∂–Ω–æ—Å—Ç–∏
- **Error Tracking**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

#### üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **–ê–∫—Ç—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ API**: –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–π–Ω—Ç–æ–≤
- **Migration Guide**: –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- **Error Handling Guide**: –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

## ÔøΩüîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.8+
- MongoDB 4.4+
- pip –∏–ª–∏ poetry

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

#### –° Poetry (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
poetry install
poetry shell
```

#### –° pip
```bash
pip install -r requirements.txt
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:
```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
MONGODB_URL=mongodb://localhost:27017
DATABASE_NAME=enter_code_site

# JWT —Ç–æ–∫–µ–Ω—ã
JWT_SECRET_KEY=your-secret-key-here
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
LOG_FILE=app.log
LOG_LEVEL=INFO

# CORS
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001
```

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

#### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

#### –ü—Ä–æ–¥–∞–∫—à–Ω
```bash
uvicorn main:app --host 0.0.0.0 --port 8000 --workers 4
```

#### –ò—Å–ø–æ–ª—å–∑—É—è VS Code Task
```bash
# Ctrl+Shift+P -> Tasks: Run Task -> Start Backend Server
```

## üóÑ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### MongoDB –∫–æ–ª–ª–µ–∫—Ü–∏–∏
- `users` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã
- `courses` - –∫—É—Ä—Å—ã
- `groups` - –≥—Ä—É–ø–ø—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- `topics` - —Ç–µ–º—ã –∫—É—Ä—Å–æ–≤
- `tasks` - –∑–∞–¥–∞—á–∏
- `task_results` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á

### –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å –≤–µ—Ä—Å–∏–π, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö `tg_username` –≤ —Å–≤—è–∑—è—Ö:

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –∏ –º–∏–≥—Ä–∞—Ü–∏—è
python migrate_to_user_id.py

# –ò–ª–∏ —Å –ø–æ–º–æ—â—å—é —Å–∫—Ä–∏–ø—Ç–∞
./run_migration.ps1  # Windows
./run_migration.sh   # Linux/Mac
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **JWT —Ç–æ–∫–µ–Ω—ã**: Access (30 –º–∏–Ω) + Refresh (7 –¥–Ω–µ–π)
- **–•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π**: bcrypt
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: —á–µ—Ä–µ–∑ refresh token

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- **–†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å**: Student < Teacher < Admin
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤**: –Ω–∞ —É—Ä–æ–≤–Ω–µ —ç–Ω–¥–ø–æ–π–Ω—Ç–æ–≤
- **–ò–∑–æ–ª—è—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**: —Å—Ç—É–¥–µ–Ω—Ç—ã –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ

### CORS
- **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –¥–æ–º–µ–Ω—ã**: —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏**: –≤–∫–ª—é—á–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–≥–∏
- **–§–∞–π–ª**: `app.log` (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
- **–£—Ä–æ–≤–Ω–∏**: INFO, WARNING, ERROR
- **–†–æ—Ç–∞—Ü–∏—è**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è

### –ó–¥–æ—Ä–æ–≤—å–µ —Å–∏—Å—Ç–µ–º—ã
```bash
GET /health
```

### –ú–µ—Ç—Ä–∏–∫–∏
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ —ç–Ω–¥–ø–æ–π–Ω—Ç–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
pytest

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=.

# –¢–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã
pytest tests/unit/

# –¢–æ–ª—å–∫–æ integration —Ç–µ—Å—Ç—ã
pytest tests/integration/
```

## üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å–∞–º:
- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc
- **OpenAPI JSON**: http://localhost:8000/openapi.json

## üöÄ –î–µ–ø–ª–æ–π

### Docker
```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t enter-code-site-backend .

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker run -p 8000:8000 --env-file .env enter-code-site-backend
```

### Docker Compose
```bash
docker-compose up -d
```

## ü§ù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
backend/
‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ database/              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ë–î
‚îú‚îÄ‚îÄ models/                # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ routers/               # API —Ä–æ—É—Ç–µ—Ä—ã
‚îú‚îÄ‚îÄ services/              # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ schemas/               # Pydantic —Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ migrate_to_user_id.py  # –°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ pip
‚îú‚îÄ‚îÄ pyproject.toml        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Poetry
‚îî‚îÄ‚îÄ README.md             # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –ö–æ–¥ —Å—Ç–∞–π–ª
- **–§–æ—Ä–º–∞—Ç—Ç–µ—Ä**: black
- **–õ–∏–Ω—Ç–µ—Ä**: flake8
- **–ò–º–ø–æ—Ä—Ç—ã**: isort
- **–¢–∏–ø—ã**: mypy

### Git hooks
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ pre-commit
pre-commit install
```

## üìà –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è: **2.0.0**

### Changelog
- **2.0.0**: –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ user_id, –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ API –æ—Ç–≤–µ—Ç—ã
- **1.0.0**: –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **Issues**: GitHub Issues
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: `/docs` —ç–Ω–¥–ø–æ–π–Ω—Ç
- **Email**: support@entercode.site

---

**–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏**